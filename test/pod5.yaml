apiVersion: v1
kind: Pod
metadata:
  labels:
    sharedgpu/gpu_limit: "1.0"
    sharedgpu/gpu_request: "0.5"
  name: pod5
  namespace: default
spec:
  containers:
  - command:
    - sh
    - -c
    - nvidia-smi -L; sleep infinity
    env:
    - name: NVIDIA_VISIBLE_DEVICES
      value: GPU-fd581f63-a0b4-8715-ad43-65d0dd0011bd,
    - name: NVIDIA_DRIVER_CAPABILITIES
      value: compute,utility
    - name: LD_PRELOAD
      value: /kubeshare/library/libgemhook.so.1
    - name: POD_MANAGER_PORT
      value: "50052"
    - name: POD_NAME
      value: default/pod1
    image: pytorch/pytorch:1.10.0-cuda11.3-cudnn8-runtime
    imagePullPolicy: IfNotPresent
    name: pytorch
    resources:
      limits:
        cpu: "1"
        memory: 4Gi
      requests:
        cpu: "1"
        memory: 4Gi
    terminationMessagePath: /dev/termination-log
    terminationMessagePolicy: File
    volumeMounts:
    - mountPath: /kubeshare/library
      name: kubeshare-lib
    - mountPath: /kubeshare/log
      name: kubeshare-log
  dnsPolicy: ClusterFirst
  enableServiceLinks: true
  nodeName: juno
  priority: 0
  restartPolicy: Always
  schedulerName: kubeshare-scheduler
  securityContext: {}
  serviceAccount: default
  serviceAccountName: default
  terminationGracePeriodSeconds: 30
  tolerations:
  - effect: NoExecute
    key: node.kubernetes.io/not-ready
    operator: Exists
    tolerationSeconds: 300
  - effect: NoExecute
    key: node.kubernetes.io/unreachable
    operator: Exists
    tolerationSeconds: 300
  volumes:
  - name: default-token-jsb7t
    secret:
      defaultMode: 420
      secretName: default-token-jsb7t
  - hostPath:
      path: /kubeshare/library
      type: ""
    name: kubeshare-lib
  - hostPath:
      path: /kubeshare/log
      type: ""
    name: kubeshare-log
